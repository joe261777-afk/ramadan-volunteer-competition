<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„ÙØ±Ù‚ Ø§Ù„ØªØ·ÙˆØ¹ÙŠØ© - Ø±Ù…Ø¶Ø§Ù†</title>

  <!-- Fonts (Arabic-friendly) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;600;700;800&family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">

<style>
  :root{
    /* Ramadan palette (like reference) */
    --navy-950:#03102b;
    --navy-900:#041a3f;
    --navy-850:#06234f;
    --navy-800:#07315e;
    --navy-700:#0a4f86;

    --gold-500:#f4c451;
    --gold-600:#d9a63b;

    --text:#f8fafc;
    --muted:rgba(248,250,252,.72);

    --line:rgba(244,196,81,.58);
    --line2:rgba(244,196,81,.28);

    --card: rgba(2, 20, 55, .62);
    --card2: rgba(3, 16, 43, .82);
    --border: rgba(244,196,81,.28);

    --ok: rgba(34,197,94,.22);
    --okBorder: rgba(34,197,94,.35);
  }

  *{ box-sizing:border-box; }

  html, body{
    width:100%;
    height:100%;
    margin:0;
    padding:0;
  }

  body{
    font-family:"Tajawal",system-ui,-apple-system,"Segoe UI",Roboto,Arial;
    /* background:#e7e7e7;  Ù„Ùˆ Ø¹Ø§ÙŠØ² Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø±Ù…Ø§Ø¯ÙŠ Ø¨Ø±Ù‘Ù‡ Ø±Ø¬Ù‘Ø¹ Ø§Ù„Ø³Ø·Ø± Ø¯Ù‡ */
    min-height:100vh;
    overflow-x:hidden;
    color:var(--text);
  }

  /* stage like screenshot */
  .stage{
    width:100%;
    max-width:none;
    margin:0;
    padding:0;
  }

  /* main canvas */
  .ramadan-canvas{
    position:relative;
    width:100%;
    min-height:100vh;
    overflow:hidden;
    background: linear-gradient(135deg, var(--navy-900), var(--navy-800) 55%, #064d83);
    box-shadow:none;
    border-radius:0;
  }

  .ramadan-canvas::before{
    content:"";
    position:absolute; inset:0;
    background:
      radial-gradient(circle at 70% 35%, rgba(255,255,255,.06), transparent 55%),
      radial-gradient(circle at 22% 85%, rgba(0,0,0,.22), transparent 55%);
    pointer-events:none;
    z-index:1;
  }

  /* ================= NAVBAR ================= */
  header.topbar{
    position: sticky;
    top: 0;
    z-index: 30;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:14px;
    padding:18px 32px;
    background: rgba(2, 20, 55, .74);
    border-bottom:2px solid var(--line);
    backdrop-filter: blur(10px);
  }

  .logo{
    font-family:"El Messiri", serif;
    font-weight:800;
    letter-spacing:.02em;
    color:var(--gold-500);
    font-size:20px;
    white-space:nowrap;
  }

  .nav{
    display:flex;
    align-items:center;
    gap:26px;
    flex-wrap:wrap;
    list-style:none;
    margin:0;
    padding:0;
    color:var(--gold-500);
    font-weight:700;
    font-size:.95rem;
  }

  .nav a{
    color:inherit;
    text-decoration:none;
    padding:6px 10px;
    border-radius:999px;
    border:1px solid transparent;
    transition:.15s ease;
  }

  .nav a:hover{
    border-color:var(--line2);
    background: rgba(244,196,81,.08);
  }

  .golden-rule{
    height:2px;
    background: linear-gradient(90deg, transparent, rgba(244,196,81,.78), transparent);
    opacity:.95;
    position:relative;
    z-index:25;
  }

  /* ================= DECOR LAYERS ================= */
  .stars{
    position:absolute;
    inset:0;
    z-index:3;
    pointer-events:none;
    opacity:.95;
  }

  /* Mosque silhouette */
  .mosque{
    position:absolute;
    left:0; right:0;
    bottom:-12px;
    height:280px;
    z-index:4;
    pointer-events:none;
    opacity:.64;
    filter: blur(.15px);
  }

  /* MOVE RAMADAN DECOR TO THE LEFT */
  .moon-wrap{
    position:absolute;
    left:10%;
    top:145px;
    width:360px;
    height:360px;
    z-index:5;
    pointer-events:none;
    filter: drop-shadow(0 18px 30px rgba(244,196,81,.18));
    opacity:.98;
  }

  .string{
    position:absolute;
    width:2px;
    background: linear-gradient(180deg, rgba(244,196,81,.9), rgba(244,196,81,.15));
    z-index:6;
    pointer-events:none;
    opacity:.85;
  }

  .string.s1{ left:18%; top:64px; height:185px; }
  .string.s2{ left:6.5%; top:0; height:225px; }
  .string.s3{ left:28.5%; top:260px; height:175px; }

  .lantern{
    position:absolute;
    top:0;
    z-index:6;
    width:120px;
    opacity:.98;
    transform-origin: top center;
    animation: swing 4.2s ease-in-out infinite;
    pointer-events:none;
  }

  .lantern.l1{ left:14%; top:86px; width:120px; animation-delay:.1s; }
  .lantern.l2{ left:2.5%; top:10px; width:150px; animation-delay:.35s; }
  .lantern.l3{ left:24%; top:320px; width:120px; animation-delay:.25s; }

  @keyframes swing{
    0%,100%{ transform: rotate(-2.2deg); }
    50%{ transform: rotate(2.2deg); }
  }

  /* ================= HERO / LAYOUT ================= */
  .hero{
    position:relative;
    z-index:10;
    display:grid;
    grid-template-columns: 1.1fr .9fr;
    gap:18px;
    padding:46px 32px 24px 32px;
    min-height:560px;
  }

  .hero::after{
    content:"";
    position:absolute;
    top:0; bottom:0;
    left:57%;
    width:2px;
    background: linear-gradient(180deg, transparent, rgba(244,196,81,.5), transparent);
    opacity:.75;
    z-index:2;
    pointer-events:none;
  }

  .hero::before{
    content:"";
    position:absolute;
    top:0; bottom:0;
    right:8.5%;
    width:2px;
    background: linear-gradient(180deg, transparent, rgba(244,196,81,.5), transparent);
    opacity:.6;
    z-index:2;
    pointer-events:none;
  }

  .hero-left{
    position:relative;
    z-index:12;
    padding-top:56px;
    text-align:right;
  }

  .hero-title{
    font-family:"El Messiri", serif;
    font-weight:800;
    font-size:64px;
    margin:0;
    color:var(--gold-500);
    text-shadow: 0 10px 30px rgba(244,196,81,.18);
    line-height:1.12;
  }

  .hero-subtitle{
    margin:14px 0 0 0;
    font-weight:800;
    color: rgba(244,196,81,.92);
    font-size:18px;
    letter-spacing:.02em;
  }

  /* Hide desc/bullets/cta */
  .hero-desc,
  .hero-bullets,
  .cta-row{
    display:none;
  }

  .hero-right{
    position:relative;
    z-index:12;
    min-height:460px;
    display:flex;
    align-items:flex-start;
    justify-content:flex-start;
    padding-top:48px;
  }

  /* ================= APP CARDS ================= */
  .glass-card{
    width: min(420px, 95%);
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 18px 16px 16px 16px;
    backdrop-filter: blur(12px);
    box-shadow: 0 18px 45px rgba(0,0,0,.25);
  }

  .glass-card h2{
    margin:0 0 12px 0;
    font-family:"El Messiri", serif;
    font-size:20px;
    color: rgba(244,196,81,.95);
    font-weight:800;
  }

 .badge{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding: 2px 10px;
  border-radius: 999px;
  background: linear-gradient(135deg, var(--gold-500), var(--gold-600));
  color:#18233d;
  font-weight: 900;
  margin-inline-end: 6px;
  gap: 6px;
}
.badge-gif{
  height: 18px;     /* ØºÙŠÙ‘Ø±Ù‡Ø§ Ù„Ùˆ Ø¹Ø§ÙŠØ²Ù‡ Ø£ÙƒØ¨Ø± */
  width: 20px;
  display:block;
}
  .hint{
    font-size:13px;
    color: rgba(248,250,252,.70);
    line-height:1.85;
    margin:0 0 10px 0;
  }

  .field-row{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    margin:10px 0;
    flex-wrap:wrap;
  }

  .field-row label{
    flex:1;
    min-width:150px;
    font-size:14px;
    color: rgba(248,250,252,.88);
    font-weight:700;
  }

  input[type="number"],
  input[type="date"],
  input[type="text"],
  input[type="password"],
  input[type="file"]{
    width:230px;
    max-width:100%;
    padding:10px 10px;
    border-radius:10px;
    border: 1px solid rgba(244,196,81,.20);
    background: var(--card2);
    color: var(--text);
    font-size:14px;
    outline:none;
    transition:.15s ease;
    font-family:inherit;
  }

  input::placeholder{ color: rgba(248,250,252,.55); }

  input:focus{
    border-color: rgba(244,196,81,.55);
    box-shadow: 0 0 0 2px rgba(244,196,81,.10);
    transform: translateY(-1px);
  }

  input[type="file"]{ padding:7px 8px; }

  button{
    margin-top:10px;
    padding:10px 16px;
    border:none;
    border-radius:999px;
    background: linear-gradient(135deg, rgba(244,196,81,.95), rgba(217,166,59,.95));
    color:#172140;
    font-size:14px;
    cursor:pointer;
    font-weight:900;
    letter-spacing:.01em;
    box-shadow: 0 14px 30px rgba(244,196,81,.20);
    transition: transform .12s ease, filter .12s ease;
    user-select:none;
  }

  button:hover{ transform: translateY(-1px); filter: brightness(1.03); }
  button:active{ transform: translateY(1px); }

  .btn-secondary{
    background: transparent;
    border: 2px solid rgba(244,196,81,.65);
    color: rgba(244,196,81,.94);
    box-shadow:none;
  }

  .btn-secondary:hover{ background: rgba(244,196,81,.09); }

  .result{
    margin-top:14px;
    font-size:14px;
    font-weight:700;
    color: rgba(244,196,81,.95);
    line-height:1.9;
    background: rgba(3, 16, 43, .75);
    border-radius:12px;
    padding:10px 12px;
    border: 1px solid rgba(244,196,81,.22);
  }

  /* sections below hero */
  .app-section{
    position:relative;
    z-index:12;
    padding:18px 32px 34px 32px;
  }

  .panel{
    background: rgba(2, 20, 55, .56);
    border: 1px solid rgba(244,196,81,.22);
    border-radius:18px;
    padding:18px 16px 18px 16px;
    box-shadow: 0 18px 55px rgba(0,0,0,.28);
    backdrop-filter: blur(12px);
  }

  .panel h2{
    margin:0 0 10px 0;
    font-family:"El Messiri", serif;
    color: rgba(244,196,81,.95);
    font-size:20px;
    font-weight:900;
  }

  h3{
    color: rgba(244,196,81,.92);
    margin:18px 0 8px 0;
    font-family:"El Messiri", serif;
    font-size:16px;
    font-weight:800;
  }

  /* tables */
  table{
    width:100%;
    border-collapse:collapse;
    margin-top:12px;
    background: rgba(3, 16, 43, .78);
    border-radius:12px;
    overflow:hidden;
    box-shadow: 0 12px 30px rgba(0,0,0,.28);
  }

  th, td{
    border: 1px solid rgba(244,196,81,.14);
    padding:8px;
    text-align:center;
    font-size:13px;
    color: rgba(248,250,252,.90);
  }

  th{
    background: linear-gradient(135deg, rgba(244,196,81,.25), rgba(10,79,134,.35));
    color: rgba(255,255,255,.92);
    font-weight:900;
  }

  tbody tr:nth-child(even){ background: rgba(3,16,43,.86); }
  tbody tr:nth-child(odd){ background: rgba(3,16,43,.70); }
  tbody tr:hover{ background: rgba(244,196,81,.08); }

  a{
    color: rgba(244,196,81,.95);
    font-weight:900;
    text-decoration:none;
  }

  a:hover{ text-decoration:underline; }

  /* progress bars */
  .target-progress-wrapper{ width:100%; margin-top:6px; margin-bottom:10px; }
  .target-progress-label{ font-size:12.5px; color: rgba(248,250,252,.70); margin-bottom:4px; }

  .target-progress-bar{
    width:100%;
    height:10px;
    border-radius:999px;
    overflow:hidden;
    background: rgba(3, 16, 43, .82);
    border: 1px solid rgba(244,196,81,.20);
  }

  .target-progress-fill{
    height:100%;
    border-radius:inherit;
    background: linear-gradient(90deg, #22c55e, #a3e635, #facc15);
    width:0%;
    transition: width 0.25s ease-out;
  }

  /* photos */
  #adminPhotosContainer img{
    max-width:140px;
    max-height:140px;
    margin:6px;
    border-radius:10px;
    border: 1px solid rgba(244,196,81,.55);
    box-shadow: 0 10px 25px rgba(0,0,0,.35);
    object-fit:cover;
  }

  /* overlay */
  .score-overlay{
    position:fixed;
    inset:0;
    background: rgba(3, 16, 43, .82);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:80;
  }

  .score-overlay.hidden{ display:none; }

  .score-overlay-content{
    width: min(420px, 92%);
    background: rgba(2,20,55,.92);
    border-radius:20px;
    padding:18px 16px 18px 16px;
    border: 1px solid rgba(244,196,81,.55);
    box-shadow: 0 24px 60px rgba(0,0,0,.45);
    text-align:center;
    backdrop-filter: blur(14px);
  }

  .score-overlay-content h2{
    margin:0 0 8px 0;
    color: rgba(244,196,81,.95);
    font-family:"El Messiri", serif;
    font-weight:900;
    font-size:18px;
  }

  .score-main{ font-size:22px; font-weight:900; margin:6px 0 10px 0; }

  .overlay-bar-wrapper{
    width:100%;
    height:12px;
    border-radius:999px;
    overflow:hidden;
    background: rgba(3, 16, 43, .82);
    border: 1px solid rgba(244,196,81,.25);
    margin-bottom:8px;
  }

  .overlay-bar-fill{
    height:100%;
    border-radius:inherit;
    background: linear-gradient(90deg, #22c55e, #a3e635, #facc15);
    width:0;
  }

  .score-rank{ font-size:14px; margin:8px 0; color: rgba(248,250,252,.90); }
  .score-trend{ font-size:13px; color: rgba(248,250,252,.70); margin-bottom:8px; }

  .score-overlay-content.rank-up{
    animation: rankUpGlow .9s ease-out;
    box-shadow: 0 0 25px rgba(244,196,81,.45), 0 0 60px rgba(244,196,81,.35);
  }

  .score-overlay-content.rank-down{
    animation: rankDownShake .7s ease-out;
    box-shadow: 0 0 25px rgba(239,68,68,.35), 0 0 60px rgba(239,68,68,.22);
  }

  .rank-down-rocket{
    font-size:28px;
    margin-bottom:6px;
    animation: rocketDown .8s ease-in forwards;
  }

  @keyframes rankUpGlow{
    0%{ transform: scale(.92); }
    40%{ transform: scale(1.03); }
    100%{ transform: scale(1); }
  }

  @keyframes rankDownShake{
    0%{ transform: translateX(0); }
    20%{ transform: translateX(-5px); }
    40%{ transform: translateX(5px); }
    60%{ transform: translateX(-4px); }
    80%{ transform: translateX(4px); }
    100%{ transform: translateX(0); }
  }

  @keyframes rocketDown{
    0%{ transform: translateY(-30px); opacity:0; }
    40%{ transform: translateY(0); opacity:1; }
    100%{ transform: translateY(40px); opacity:0; }
  }

  .hidden{ display:none; }

  /* days summary toggle */
  #toggleDaysButton{ margin-top:12px; }
  #daysSummarySection{ margin-top:10px; }

  /* Responsive */
  @media (max-width: 980px){
    .hero{ grid-template-columns:1fr; }
    .hero::after, .hero::before{ display:none; }

    .moon-wrap{ left:12%; top:120px; width:320px; height:320px; }
    .lantern.l1{ left:14%; }
    .lantern.l2{ left:2%; width:130px; }
    .lantern.l3{ left:24%; }

    header.topbar{ padding:14px 16px; }
    .app-section{ padding:14px 16px 24px 16px; }
    .hero{ padding:26px 16px 16px 16px; }
    .hero-title{ font-size:44px; }
  }

  @media (max-width: 600px){
    .moon-wrap{ left:8%; top:150px; width:260px; height:260px; }
    .nav{ gap:10px; font-size:.9rem; }

    input[type="number"],
    input[type="date"],
    input[type="text"],
    input[type="password"],
    input[type="file"]{ width:100%; }

    .field-row label{ min-width:100%; }
  }
</style>


<body>
  <div class="stage">
    <div class="ramadan-canvas">

      <!-- NAVBAR -->
      <header class="topbar">
        <div class="logo">Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„ÙØ±Ù‚ Ø§Ù„ØªØ·ÙˆØ¹ÙŠØ©</div>
        <ul class="nav">
          <li><a href="#" onclick="goBackToLogin();return false;">Ø§Ù„Ø¯Ø®ÙˆÙ„</a></li>
          <li><a href="#" onclick="openLeaderboard();return false;">Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù</a></li>
          <li><a href="#app">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†Ù‚Ø§Ø·</a></li>
          <li><a href="#admin">Ø§Ù„Ø£Ø¯Ù…Ù†</a></li>
        </ul>
      </header>
      <div class="golden-rule"></div>

      <!-- Stars -->
      <svg class="stars" viewBox="0 0 1200 650" preserveAspectRatio="none" aria-hidden="true">
        <defs>
          <radialGradient id="starGlow" cx="50%" cy="50%" r="50%">
            <stop offset="0%" stop-color="white" stop-opacity="1"/>
            <stop offset="60%" stop-color="white" stop-opacity=".35"/>
            <stop offset="100%" stop-color="white" stop-opacity="0"/>
          </radialGradient>
        </defs>
        <g opacity=".85">
          <circle cx="820" cy="170" r="38" fill="url(#starGlow)" opacity=".55"/>
          <circle cx="960" cy="210" r="24" fill="url(#starGlow)" opacity=".45"/>
          <circle cx="720" cy="260" r="18" fill="url(#starGlow)" opacity=".35"/>
          <g fill="white" opacity=".85">
            <circle cx="740" cy="120" r="1.6"/>
            <circle cx="880" cy="130" r="1.2"/>
            <circle cx="1010" cy="160" r="1.4"/>
            <circle cx="1120" cy="210" r="1.3"/>
            <circle cx="860" cy="280" r="1.2"/>
            <circle cx="780" cy="310" r="1.1"/>
            <circle cx="930" cy="330" r="1.2"/>
            <circle cx="1060" cy="290" r="1.1"/>
          </g>
        </g>
      </svg>

      <!-- Moon -->
      <svg class="moon-wrap" viewBox="0 0 420 420" aria-hidden="true">
        <defs>
          <radialGradient id="moonGrad" cx="35%" cy="30%" r="70%">
            <stop offset="0%" stop-color="#fff3cf" stop-opacity="1"/>
            <stop offset="45%" stop-color="#f4c451" stop-opacity=".98"/>
            <stop offset="100%" stop-color="#d19a2f" stop-opacity="1"/>
          </radialGradient>
          <filter id="softGlow" x="-50%" y="-50%" width="200%" height="200%">
            <feGaussianBlur stdDeviation="6" result="blur"/>
            <feMerge>
              <feMergeNode in="blur"/>
              <feMergeNode in="SourceGraphic"/>
            </feMerge>
          </filter>
        </defs>

        <path filter="url(#softGlow)"
              d="M275 65c-45 22-76 69-76 123 0 63 42 116 100 133-22 18-51 29-83 29-73 0-132-59-132-132S143 86 216 86c21 0 41 5 59 14z"
              fill="url(#moonGrad)"
              opacity=".98"/>

        <path filter="url(#softGlow)"
              d="M330 170l11 23 25 4-18 17 4 24-22-12-22 12 4-24-18-17 25-4z"
              fill="#ffe7a1"
              opacity=".95"/>
      </svg>

      <!-- Strings -->
      <div class="string s1"></div>
      <div class="string s2"></div>
      <div class="string s3"></div>

      <!-- Lanterns (SVG) -->
      <svg class="lantern l1" viewBox="0 0 120 220" aria-hidden="true">
        <defs>
          <linearGradient id="lanGold" x1="0" x2="0" y1="0" y2="1">
            <stop offset="0" stop-color="#fff3cf"/>
            <stop offset="0.45" stop-color="#f4c451"/>
            <stop offset="1" stop-color="#c98b24"/>
          </linearGradient>
          <linearGradient id="glass" x1="0" x2="1">
            <stop offset="0" stop-color="#a7f3d0" stop-opacity=".15"/>
            <stop offset="1" stop-color="#93c5fd" stop-opacity=".22"/>
          </linearGradient>
        </defs>
        <path d="M60 14c14 0 24 8 24 18v14H36V32c0-10 10-18 24-18z" fill="url(#lanGold)"/>
        <path d="M34 46h52l-8 18v98l8 18H34l8-18V64z" fill="url(#lanGold)"/>
        <rect x="44" y="70" width="32" height="78" rx="10" fill="url(#glass)" stroke="rgba(255,255,255,.25)"/>
        <circle cx="60" cy="110" r="18" fill="rgba(255,255,255,.12)"/>
        <path d="M44 198h32l-6 12H50z" fill="url(#lanGold)"/>
      </svg>

      <svg class="lantern l2" viewBox="0 0 120 220" aria-hidden="true">
        <defs>
          <linearGradient id="lanGold2" x1="0" x2="0" y1="0" y2="1">
            <stop offset="0" stop-color="#fff3cf"/>
            <stop offset="0.45" stop-color="#f4c451"/>
            <stop offset="1" stop-color="#c98b24"/>
          </linearGradient>
          <linearGradient id="glass2" x1="0" x2="1">
            <stop offset="0" stop-color="#a7f3d0" stop-opacity=".15"/>
            <stop offset="1" stop-color="#93c5fd" stop-opacity=".22"/>
          </linearGradient>
        </defs>
        <path d="M60 14c14 0 24 8 24 18v14H36V32c0-10 10-18 24-18z" fill="url(#lanGold2)"/>
        <path d="M34 46h52l-8 18v98l8 18H34l8-18V64z" fill="url(#lanGold2)"/>
        <rect x="44" y="70" width="32" height="78" rx="10" fill="url(#glass2)" stroke="rgba(255,255,255,.25)"/>
        <circle cx="60" cy="110" r="18" fill="rgba(255,255,255,.12)"/>
        <path d="M44 198h32l-6 12H50z" fill="url(#lanGold2)"/>
      </svg>

      <svg class="lantern l3" viewBox="0 0 120 220" aria-hidden="true">
        <defs>
          <linearGradient id="lanGold3" x1="0" x2="0" y1="0" y2="1">
            <stop offset="0" stop-color="#fff3cf"/>
            <stop offset="0.45" stop-color="#f4c451"/>
            <stop offset="1" stop-color="#c98b24"/>
          </linearGradient>
          <linearGradient id="glass3" x1="0" x2="1">
            <stop offset="0" stop-color="#a7f3d0" stop-opacity=".15"/>
            <stop offset="1" stop-color="#93c5fd" stop-opacity=".22"/>
          </linearGradient>
        </defs>
        <path d="M60 14c14 0 24 8 24 18v14H36V32c0-10 10-18 24-18z" fill="url(#lanGold3)"/>
        <path d="M34 46h52l-8 18v98l8 18H34l8-18V64z" fill="url(#lanGold3)"/>
        <rect x="44" y="70" width="32" height="78" rx="10" fill="url(#glass3)" stroke="rgba(255,255,255,.25)"/>
        <circle cx="60" cy="110" r="18" fill="rgba(255,255,255,.12)"/>
        <path d="M44 198h32l-6 12H50z" fill="url(#lanGold3)"/>
      </svg>

      <!-- Mosque silhouette -->
      <svg class="mosque" viewBox="0 0 1200 260" preserveAspectRatio="none" aria-hidden="true">
        <defs>
          <linearGradient id="mosq" x1="0" x2="0" y1="0" y2="1">
            <stop offset="0" stop-color="#0b3a69" stop-opacity=".85"/>
            <stop offset="1" stop-color="#041a3f" stop-opacity="1"/>
          </linearGradient>
        </defs>
        <path fill="url(#mosq)" opacity=".95"
          d="M0 260V170c40-10 70-30 95-60 24-29 55-45 90-50v-6c0-10 8-18 18-18s18 8 18 18v9
             c45 10 79 33 105 70 25 36 62 55 112 58v-40c0-18 14-32 32-32h16c-2-8-3-16-3-24
             0-46 33-86 78-96-2-5-3-10-3-15 0-26 21-47 47-47s47 21 47 47c0 5-1 10-3 15
             45 10 78 50 78 96 0 8-1 16-3 24h16c18 0 32 14 32 32v40c50-3 87-22 112-58
             26-37 60-60 105-70v-9c0-10 8-18 18-18s18 8 18 18v6c35 5 66 21 90 50
             25 30 55 50 95 60v90H0z"/>
      </svg>

      <!-- HERO -->
      <section class="hero">
        <!-- âœ… ÙŠÙ…ÙŠÙ†: Ø¹Ù†ÙˆØ§Ù† ÙÙ‚Ø· -->
        <div class="hero-left">
          <h1 class="hero-title">Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„ÙØ±Ù‚ Ø§Ù„ØªØ·ÙˆØ¹ÙŠØ©</h1>
          <div class="hero-subtitle">Ø±Ù…Ø¶Ø§Ù† â€” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†Ù‚Ø§Ø· â€¢ ØªØ±ØªÙŠØ¨ Ø§Ù„ÙØ±Ù‚ â€¢ Ù„ÙˆØ­Ø© Ø´Ø±Ù Ù…Ø¨Ø§Ø´Ø±Ø©</div>

          <!-- âœ… Ø§ØªØ³Ø§Ø¨ÙˆØ§ Ù…ÙˆØ¬ÙˆØ¯ÙŠÙ† Ø¨Ø³ Ù…Ø®ÙÙŠÙŠÙ† Ø¨Ø§Ù„Ù€ CSS -->
          <p class="hero-desc">
            ÙˆÙŠØ¨ Ø³Ø§ÙŠØª Ù„Ø¥Ø¯Ø§Ø±Ø© Ù…Ø³Ø§Ø¨Ù‚Ø© Ø±Ù…Ø¶Ø§Ù†ÙŠØ© Ø¨ÙŠÙ† ÙØ±Ù‚ ØªØ·ÙˆØ¹ÙŠØ© Ø¨Ø´ÙƒÙ„ Ø³Ù‡Ù„ ÙˆØ¹Ø§Ø¯Ù„: Ù‚Ø§Ø¦Ø¯ Ø§Ù„ÙØ±ÙŠÙ‚ ÙŠØ³Ø¬Ù„ Ù†Ù‚Ø§Ø· ÙŠÙˆÙ…Ù‡ Ø¨ØªØ§Ø±ÙŠØ® (Ø¨Ø¯ÙˆÙ† ØªÙƒØ±Ø§Ø±)ØŒ
            ÙˆØ§Ù„Ø£Ø¯Ù…Ù† ÙŠØ±Ø§Ø¬Ø¹ Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ´ÙŠØª Ø§Ù„Ø­Ø¶ÙˆØ±ØŒ ÙˆØ§Ù„Ù†ØªØ§Ø¦Ø¬ ØªØ¸Ù‡Ø± ÙÙˆØ±Ù‹Ø§ Ø¹Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù.
          </p>

          <ul class="hero-bullets">
            <li>ØªØ³Ø¬ÙŠÙ„ ÙŠÙˆÙ…ÙŠ Ù„Ù„Ù†Ù‚Ø§Ø· + Ù…Ù†Ø¹ ØªØ³Ø¬ÙŠÙ„ Ù†ÙØ³ Ø§Ù„ÙŠÙˆÙ… Ù…Ø±ØªÙŠÙ† Ù„Ù†ÙØ³ Ø§Ù„ÙØ±ÙŠÙ‚.</li>
            <li>Ù†Ø¸Ø§Ù… Ø¯Ø±Ø¬Ø§Øª Ù…Ù† 100%: (55% Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒ) + (15% ÙŠØ¯ÙˆÙŠ Ù„Ù„Ø£Ø¯Ù…Ù†) + (30% ØªØ¨Ø±Ø¹Ø§Øª/Ù…Ù†ØªØ¬Ø§Øª ØªØ±Ø§ÙƒÙ…ÙŠ).</li>
            <li>Pop-up Ù„Ø·ÙŠÙ ÙŠÙˆØ¶Ø­ Ø§Ù„Ù€ Score ÙˆØ§Ù„Ù…Ø±ÙƒØ² ÙˆØ§Ù„Ù…ÙŠØ¯Ø§Ù„ÙŠØ© ğŸ¥‡ğŸ¥ˆğŸ¥‰.</li>
            <li>Leaderboard Ø¹Ø§Ù… ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Firebase Realtime Database.</li>
          </ul>

          <div class="cta-row">
            <a class="cta primary" href="#" onclick="openLeaderboard();return false;">ğŸ† Ø§ÙØªØ­ Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù</a>
            <a class="cta" href="#app">Ø§Ø¨Ø¯Ø£ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†Ù‚Ø§Ø·</a>
          </div>
        </div>

        <!-- âœ… Ø´Ù…Ø§Ù„: Ù†ÙØ³ ÙƒØ§Ø±Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø²ÙŠ Ù…Ø§ Ù‡Ùˆ -->
        <div class="hero-right">
          <div id="loginSection" class="glass-card">
            <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>

            <div class="field-row">
              <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</label>
              <input type="text" id="loginName" placeholder="Ù…Ø«Ø§Ù„: admin Ø£Ùˆ ÙØ±ÙŠÙ‚ Ø§Ù„Ø±Ø­Ù…Ø©" />
            </div>

            <div class="field-row">
              <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
              <input type="password" id="loginPassword" placeholder="Ù„Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·" />
            </div>

            <button onclick="handleLogin()">Ø¯Ø®ÙˆÙ„</button>
            <button class="btn-secondary" type="button" onclick="openLeaderboard()" style="margin-top:10px;">
              Ù…Ø´Ø§Ù‡Ø¯Ø© Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù
            </button>

            <p class="hint" style="margin-top:12px;">
              <span class="badge">  <img src="crescent-moon.gif"  class="badge-gif">
</span>
            </p>
          </div>
        </div>
      </section>

      <!-- APP (User/Admin) -->
      <div class="app-section" id="app">

        <!-- User Page -->
        <div id="userSection" class="panel hidden">
          <h2>ØµÙØ­Ø© Ù‚Ø§Ø¦Ø¯ Ø§Ù„ÙØ±ÙŠÙ‚</h2>
          <p class="hint" id="userWelcome"></p>

          <div class="field-row">
            <label>Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚:</label>
            <input type="text" id="teamName" disabled />
          </div>

          <div class="field-row">
            <label>Ø¹Ø¯Ø¯ Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„ÙØ±ÙŠÙ‚ (Ø§Ù„ÙƒØ§Ù…Ù„):</label>
            <input type="number" id="teamSize" min="1" placeholder="Ù…Ø«Ø§Ù„: 15" />
          </div>

          <div class="field-row">
            <label>ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ…:</label>
            <input type="date" id="dayDate" />
          </div>

          <h3>Ø§Ù„ØªØ¹Ø¨Ø¦Ø© (Ø¥Ø¬Ù…Ø§Ù„ÙŠ ÙˆØ²Ù† Ø§Ù„Ù‚Ø³Ù… = Ù¤Ù Ùª)</h3>

          <div class="field-row">
            <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ù†Ø· Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø§Ù„ÙŠÙˆÙ… (ØªØ§Ø±Ø¬Øª Ø§Ù„ÙŠÙˆÙ…):</label>
            <input type="number" id="bags_target" min="0" placeholder="Ù…Ø«Ø§Ù„: 100" />
          </div>

          <div class="field-row">
            <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ù†Ø· Ø§Ù„Ù„ÙŠ Ø§ØªØ¹Ù…Ù„Øª ÙØ¹Ù„Ø§Ù‹ Ø§Ù„ÙŠÙˆÙ…:</label>
            <input type="number" id="bags_done" min="0" placeholder="Ù…Ø«Ø§Ù„: 80" />
          </div>

          <p class="hint">Ù†Ø³Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø´Ù†Ø· = (Ø§Ù„Ù…Ù†ÙØ° Ã· Ø§Ù„Ù…Ø·Ù„ÙˆØ¨) Ã— Ù¢Ù Ùª.</p>

          <div class="field-row">
            <label>ØµÙˆØ± Ø¬ÙˆØ¯Ø© Ø§Ù„ØªØ¹Ø¨Ø¦Ø© ÙˆØ§Ù„Ù†Ø¸Ø§Ù… (ØªÙ‚ÙŠÙŠÙ… Ø£Ø¯Ù…Ù†):</label>
            <input type="file" id="fill_quality_photos" accept="image/*" multiple />
          </div>

          <div class="field-row">
            <label>Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ :</label>
             <input type="number" id="fill_time_display" disabled placeholder="Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¨Ø¹Ø¯" />
              </div>

              <p class="hint" id="fillTimeHint">
                Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø±Ø¬Ø© ÙŠØªÙ… Ø¥Ø¯Ø®Ø§Ù„Ù‡Ø§ Ù…Ù† Ø§Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·ØŒ ÙˆØ³ØªØ¸Ù‡Ø± Ù„Ùƒ Ù‡Ù†Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©.
              </p>

          <h3>Ø§Ù„ØªØ¨Ø±Ø¹Ø§Øª (ØªØ±Ø§ÙƒÙ…ÙŠ â€“ Ø¥Ø¬Ù…Ø§Ù„ÙŠ ÙˆØ²Ù† Ø§Ù„Ù‚Ø³Ù… = Ù¢Ù¥Ùª)</h3>

          <div class="field-row">
            <label>Ø§Ù„Ù…Ø¬Ø²ÙØ± â€“ Ù…Ø¨Ù„Øº Ø§Ù„ÙŠÙˆÙ… (ØªØ§Ø±Ø¬Øª Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© 15000):</label>
            <input type="number" id="donation_meat" min="0" placeholder="Ù…Ø¨Ù„Øº Ø§Ù„ÙŠÙˆÙ… Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡" />
          </div>
          <div class="target-progress-wrapper">
            <div class="target-progress-label">
              ØªÙ‚Ø¯Ù… Ø§Ù„Ù…Ø¬Ø²Ø±: <span id="meatProgressText">0 / 15000 (0Ùª)</span>
            </div>
            <div class="target-progress-bar">
              <div id="meatProgressFill" class="target-progress-fill"></div>
            </div>
          </div>

          <div class="field-row">
            <label>Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØª â€“ Ù…Ø¨Ù„Øº Ø§Ù„ÙŠÙˆÙ… (ØªØ§Ø±Ø¬Øª Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© 5000):</label>
            <input type="number" id="donation_house" min="0" placeholder="Ù…Ø¨Ù„Øº Ø§Ù„ÙŠÙˆÙ… Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡" />
          </div>
          <div class="target-progress-wrapper">
            <div class="target-progress-label">
              ØªÙ‚Ø¯Ù… Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØª: <span id="houseProgressText">0 / 5000 (0Ùª)</span>
            </div>
            <div class="target-progress-bar">
              <div id="houseProgressFill" class="target-progress-fill"></div>
            </div>
          </div>

          <div class="field-row">
            <label>ØªÙ†ÙˆØ¹ â€“ Ø¹Ø¯Ø¯ Ø£Ù†ÙˆØ§Ø¹/Ù…ØµØ§Ø¯Ø± Ø§Ù„ØªØ¨Ø±Ø¹ Ø§Ù„ÙŠÙˆÙ…:</label>
            <input type="number" id="donation_variety" min="0" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„ÙŠÙˆÙ…" />
          </div>

          <h3>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (ØªØ±Ø§ÙƒÙ…ÙŠ â€“ ÙˆØ²Ù† Ø§Ù„Ø¨Ù†Ø¯ = Ù¥Ùª)</h3>

          <div class="field-row">
            <label>Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ÙŠÙˆÙ… (ØªØ§Ø±Ø¬Øª Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© 3000):</label>
            <input type="number" id="products_today" min="0" placeholder="Ù…Ø¨Ù„Øº Ø§Ù„ÙŠÙˆÙ… Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡" />
          </div>
          <div class="target-progress-wrapper">
            <div class="target-progress-label">
              ØªÙ‚Ø¯Ù… Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: <span id="productsProgressText">0 / 3000 (0Ùª)</span>
            </div>
            <div class="target-progress-bar">
              <div id="productsProgressFill" class="target-progress-fill"></div>
            </div>
          </div>

          <h3>Ø§Ù„ØªØ§Ø±Ø¬Øª Ø§Ù„ØªØ·ÙˆØ¹ÙŠ (Ø¥Ø¬Ù…Ø§Ù„ÙŠ ÙˆØ²Ù† Ø§Ù„Ù‚Ø³Ù… = Ù£Ù Ùª)</h3>

          <div class="field-row">
            <label>Ø­Ø¶ÙˆØ± Ø§Ù„ÙØ±ÙŠÙ‚ (Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ† Ø§Ù„ÙŠÙˆÙ… Ù…Ù† Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ø¯Ø¯ Ø§Ù„ÙØ±ÙŠÙ‚):</label>
            <input type="number" id="vol_team_presence" min="0" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…" />
          </div>

          <div class="field-row">
            <label>Ø§Ù„Ù…ØªØ·ÙˆØ¹ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯ (0 â†’ 25):</label>
            <input type="number" id="vol_new_volunteers" min="0" max="25" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„ÙŠÙˆÙ…" />
          </div>

          <div class="field-row">
            <label>Ø±Ø§Ø¨Ø· Ø´ÙŠØª Ø§Ù„Ø­Ø¶ÙˆØ± (Google Sheets / Drive):</label>
            <input type="text" id="vol_sheet_link" placeholder="Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ø´ÙŠØª Ù‡Ù†Ø§" />
          </div>

          <p class="hint">Ø´ÙŠØª Ø§Ù„Ø­Ø¶ÙˆØ± + Ø¬ÙˆØ¯Ø© Ø§Ù„ØªØ¹Ø¨Ø¦Ø© ÙŠØªÙ… ØªÙ‚ÙŠÙŠÙ…Ù‡Ù… ÙŠØ¯ÙˆÙŠÙ‹Ø§ Ù…Ù† ØµÙØ­Ø§Øª Ø§Ù„Ø£Ø¯Ù…Ù†.</p>

          <button onclick="calculateDay()">Ø§Ø­Ø³Ø¨ Ù†Ù‚Ø§Ø· Ø§Ù„ÙŠÙˆÙ…</button>
          <div class="result" id="resultText"></div>

          <button id="toggleDaysButton" class="btn-secondary" type="button" onclick="toggleDaysSummary()">Ø¥Ø¸Ù‡Ø§Ø± Ù…Ù„Ø®Øµ Ø§Ù„Ø£ÙŠØ§Ù…</button>

          <div id="daysSummarySection" class="hidden">
            <h3>Ù…Ù„Ø®Øµ Ø§Ù„Ø£ÙŠØ§Ù… Ù„ÙØ±ÙŠÙ‚Ùƒ</h3>
            <table>
              <thead>
                <tr>
                  <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                  <th>Ù†Ø³Ø¨Ø© Ø§Ù„ÙŠÙˆÙ… (ØªØ¹Ø¨Ø¦Ø© + ØªØ·ÙˆØ¹ Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒ)</th>
                  <th>ØªØ¨Ø±Ø¹Ø§Øª Ø§Ù„Ù…Ø¬Ø²Ø± (Ø§Ù„ÙŠÙˆÙ…)</th>
                  <th>ØªØ¨Ø±Ø¹Ø§Øª Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø¨ÙŠØª (Ø§Ù„ÙŠÙˆÙ…)</th>
                  <th>ØªÙ†ÙˆØ¹ (Ø§Ù„ÙŠÙˆÙ…)</th>
                  <th>Ù…Ù†ØªØ¬Ø§Øª (Ø§Ù„ÙŠÙˆÙ…)</th>
                </tr>
              </thead>
              <tbody id="daysTableBody"></tbody>
            </table>
          </div>

          <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;">
            <button type="button" class="btn-secondary" onclick="openLeaderboard()">ğŸ† Ø§ÙØªØ­ Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù</button>
            <button type="button" class="btn-secondary" onclick="goBackToLogin()">Ø®Ø±ÙˆØ¬</button>
          </div>
        </div>

        <!-- Admin Page -->
        <div id="adminSection" class="panel hidden" style="margin-top:14px;">
          <h2 id="admin">ØµÙØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†</h2>
          <p class="hint">
            Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© ØªØ¹Ø±Ø¶ Ù…Ù„Ø®Øµ ÙƒÙ„ Ø§Ù„ÙØ±Ù‚ ÙˆØªØ±ØªÙŠØ¨Ù‡Ù… Ø­Ø³Ø¨ Ø§Ù„Ù€ Score Ø§Ù„ÙƒÙ„ÙŠ (Ù…Ù† Ù¡Ù Ù )ØŒ ÙˆÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª Ø§Ù„ÙŠØ¯ÙˆÙŠØ©.
          </p>

          <button onclick="buildAdminTable()">ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ù‚</button>

          <h3>Ù…Ù„Ø®Øµ Ø§Ù„ÙØ±Ù‚</h3>
          <table>
            <thead>
              <tr>
                <th>Ø§Ù„ØªØ±ØªÙŠØ¨</th>
                <th>Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚</th>
                <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…</th>
                <th>Ù…ØªÙˆØ³Ø· (ØªØ¹Ø¨Ø¦Ø© + ØªØ·ÙˆØ¹ Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒ) Ùª</th>
                <th>Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ¨Ø±Ø¹Ø§Øª ÙˆØ§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ùª</th>
                <th>Ø¯Ø±Ø¬Ø© Ø¬ÙˆØ¯Ø© Ø§Ù„ØªØ¹Ø¨Ø¦Ø© (0â€“10)</th>
                <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
                <th>Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ (0â€“10)</th>
                <th>Ø¯Ø±Ø¬Ø© Ø´ÙŠØª Ø§Ù„Ø­Ø¶ÙˆØ± (0â€“5)</th>
                <th>Score Ø§Ù„ÙƒÙ„ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ Ùª</th>
                <th>ØµÙˆØ± Ø§Ù„Ø¬ÙˆØ¯Ø©</th>
                <th>Ø±Ø§Ø¨Ø· Ø´ÙŠØª Ø§Ù„Ø­Ø¶ÙˆØ±</th>
              </tr>
            </thead>
            <tbody id="adminTableBody"></tbody>
          </table>

          <h3>Ø¹Ø±Ø¶ ØµÙˆØ± Ø¬ÙˆØ¯Ø© Ø§Ù„ØªØ¹Ø¨Ø¦Ø© Ù„Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ø®ØªØ§Ø±</h3>
          <div id="adminPhotosContainer" class="result"></div>

          <button type="button" class="btn-secondary" onclick="goBackToLogin()">Ø®Ø±ÙˆØ¬</button>
        </div>

      </div>

      <!-- Pop-up Ù„Ù„Ù€ New Score -->
      <div id="scoreOverlay" class="score-overlay hidden">
        <div id="scoreOverlayContent" class="score-overlay-content"></div>
      </div>

      <!-- âœ… FIREBASE + APP LOGIC (Realtime Database) -->
      <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
        import { getDatabase, ref, get, set } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-database.js";

        const firebaseConfig = {
          apiKey: "AIzaSyDSxSRKH-cZFk9y4AqzrmFQftXcxI_ADSk",
          authDomain: "ramdan-92ed1.firebaseapp.com",
          databaseURL: "https://ramdan-92ed1-default-rtdb.firebaseio.com",
          projectId: "ramdan-92ed1",
          storageBucket: "ramdan-92ed1.firebasestorage.app",
          messagingSenderId: "467097580348",
          appId: "1:467097580348:web:52ebc0b97988857a60a439",
          measurementId: "G-YZSM40GPXF"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        const ITEM_MAX_PERCENT = {
          fill_daily_target: 20,
          fill_quality: 10,
          fill_time: 10,
          donation_meat: 10,
          donation_house: 10,
          donation_variety: 5,
          products: 5,
          vol_team_presence: 15,
          vol_new_volunteers: 10,
          vol_sheet: 5
        };

        const MAX_NON_DONATION_PERCENT =
          ITEM_MAX_PERCENT.fill_daily_target +
          ITEM_MAX_PERCENT.fill_time +
          ITEM_MAX_PERCENT.vol_team_presence +
          ITEM_MAX_PERCENT.vol_new_volunteers;

        const MANUAL_EXTRA_MAX =
          ITEM_MAX_PERCENT.fill_quality + ITEM_MAX_PERCENT.vol_sheet;

        const MAX_DONATION_PERCENT =
          ITEM_MAX_PERCENT.donation_meat +
          ITEM_MAX_PERCENT.donation_house +
          ITEM_MAX_PERCENT.donation_variety +
          ITEM_MAX_PERCENT.products;

        const MAX_TOTAL_PERCENT = MAX_NON_DONATION_PERCENT + MANUAL_EXTRA_MAX + MAX_DONATION_PERCENT;

        const DONATION_TARGETS = {
          donation_meat: 15000,
          donation_house: 5000,
          donation_variety: 10,
          products: 3000
        };

        let currentTeamName = null;
        let currentTeamKey = null;
        const sessionMedia = {};

        function getMedal(rank) {
          if (rank === 1) return " ğŸ¥‡";
          if (rank === 2) return " ğŸ¥ˆ";
          if (rank === 3) return " ğŸ¥‰";
          return "";
        }

        function openLeaderboard() {
          window.location.href = "leaderboard.html";
        }
        window.openLeaderboard = openLeaderboard;

        function teamKeyFromName(name) {
          return encodeURIComponent(name.trim());
        }

        async function getTeamsStats() {
          const snap = await get(ref(db, "teamsStats"));
          return snap.exists() ? (snap.val() || {}) : {};
        }

        async function setTeamsStats(stats) {
          await set(ref(db, "teamsStats"), stats || {});
        }

        function showSection(id) {
          document.getElementById('loginSection').classList.add('hidden');
          document.getElementById('userSection').classList.add('hidden');
          document.getElementById('adminSection').classList.add('hidden');
          document.getElementById(id).classList.remove('hidden');
        }

        function setToday() {
          const todayInput = document.getElementById('dayDate');
          const today = new Date();
          const yyyy = today.getFullYear();
          const mm = String(today.getMonth() + 1).padStart(2, '0');
          const dd = String(today.getDate()).padStart(2, '0');
          todayInput.value = `${yyyy}-${mm}-${dd}`;
        }

        async function handleLogin() {
          const name = document.getElementById('loginName').value.trim();
          const pass = document.getElementById('loginPassword').value;

          if (!name) {
            alert('Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…');
            return;
          }

          if (name === 'admin' && pass === 'admin123') {
            currentTeamName = null;
            currentTeamKey = null;
            showSection('adminSection');
            await buildAdminTable();
            return;
          }

          currentTeamName = name;
          currentTeamKey = teamKeyFromName(currentTeamName);

          showSection('userSection');
          document.getElementById('teamName').value = currentTeamName;
          document.getElementById('userWelcome').textContent =
            `Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ù‚Ø§Ø¦Ø¯ ÙØ±ÙŠÙ‚ "${currentTeamName}". Ù‚Ù… Ø¨ØªØ³Ø¬ÙŠÙ„ Ù†Ù‚Ø§Ø· Ø§Ù„ÙŠÙˆÙ… Ù„ÙØ±ÙŠÙ‚Ùƒ.`;

          setToday();
          document.getElementById('daysTableBody').innerHTML = '';
          document.getElementById('resultText').innerHTML = '';
          document.getElementById('daysSummarySection').classList.add('hidden');
          document.getElementById('toggleDaysButton').textContent = 'Ø¥Ø¸Ù‡Ø§Ø± Ù…Ù„Ø®Øµ Ø§Ù„Ø£ÙŠØ§Ù…';

          const stats = await getTeamsStats();
          const t = stats[currentTeamKey];
          updateMoneyProgressBars(t || null);
          // Show admin-set "fill_time" for today's date (if exists)
          const todayDate = document.getElementById('dayDate')?.value;
          const fillTimeDisplay = document.getElementById('fill_time_display');
          if (fillTimeDisplay) {
            const v = t?.fillTimeByDate?.[todayDate];
            if (typeof v === 'number') {
              fillTimeDisplay.value = v;
              document.getElementById('fillTimeHint').textContent =
                `ØªÙ… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯: ${v} Ù…Ù† 25 (Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ø£Ø¯Ù…Ù†).`;
            } else {
              fillTimeDisplay.value = '';
              document.getElementById('fillTimeHint').textContent =
                'Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø±Ø¬Ø© ÙŠØªÙ… Ø¥Ø¯Ø®Ø§Ù„Ù‡Ø§ Ù…Ù† Ø§Ù„Ø£Ø¯Ù…Ù† ÙÙ‚Ø·ØŒ ÙˆØ³ØªØ¸Ù‡Ø± Ù„Ùƒ Ù‡Ù†Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©.';
            }
          }

          if (t && t.daysCount > 0) {
            const overallStats = computeTeamOverallStats(t);

            const scores = [];
            Object.keys(stats).forEach(k => {
              const ts = stats[k];
              if (ts && ts.daysCount > 0) {
                const s = computeTeamOverallStats(ts);
                scores.push({ key: k, name: ts.name || decodeURIComponent(k), score: s.overallCurrent });
              }
            });
            scores.sort((a, b) => b.score - a.score);
            const rank = scores.findIndex(x => x.key === currentTeamKey) + 1;
            const totalTeams = scores.length;

            document.getElementById('resultText').innerHTML =
              `ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙØ±ÙŠÙ‚ Ø¨Ù†Ø¬Ø§Ø­. Score Ø§Ù„Ø­Ø§Ù„ÙŠ: ${overallStats.overallCurrent.toFixed(1)}Ùª â€“ Ø§Ù„Ù…Ø±ÙƒØ²: ${rank} Ù…Ù† ${totalTeams} ÙØ±ÙŠÙ‚${getMedal(rank)}.`;
          }

          document.getElementById('app')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function goBackToLogin() {
          currentTeamName = null;
          currentTeamKey = null;
          showSection('loginSection');
          document.getElementById('loginSection')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function toggleDaysSummary() {
          const sec = document.getElementById('daysSummarySection');
          const btn = document.getElementById('toggleDaysButton');
          const isHidden = sec.classList.toggle('hidden');
          btn.textContent = isHidden ? 'Ø¥Ø¸Ù‡Ø§Ø± Ù…Ù„Ø®Øµ Ø§Ù„Ø£ÙŠØ§Ù…' : 'Ø¥Ø®ÙØ§Ø¡ Ù…Ù„Ø®Øµ Ø§Ù„Ø£ÙŠØ§Ù…';
        }

        function getNumber(id) {
          const el = document.getElementById(id);
          if (!el) return 0;
          return Number(el.value) || 0;
        }

        function scoreDailyBags() {
          const target = getNumber('bags_target');
          const done   = getNumber('bags_done');
          const maxPercent = ITEM_MAX_PERCENT.fill_daily_target;
          if (target <= 0) return 0;
          const ratio = Math.max(0, Math.min(done / target, 1));
          return ratio * maxPercent;
        }

        function calcPercentFromValue(value, maxPercent) {
          if (value >= 20) return maxPercent;
          if (value >= 15) return maxPercent - 2;
          if (value >= 10) return maxPercent - 4;
          if (value >= 5)  return maxPercent - 6;
          if (value > 0)   return maxPercent - 8;
          return 0;
        }

        function scoreItem(id) {
          const value = getNumber(id);
          const maxPercent = ITEM_MAX_PERCENT[id] || 0;
          return calcPercentFromValue(value, maxPercent);
        }

        function scoreVolTeamPresence() {
          const teamSize = getNumber('teamSize');
          const present = getNumber('vol_team_presence');
          const maxPercent = ITEM_MAX_PERCENT.vol_team_presence;

          if (teamSize <= 0) return 0;
          const ratio = Math.max(0, Math.min(present / teamSize, 1));
          return ratio * maxPercent;
        }

        function calcDonationPercent(totalAmount, target, maxPercent) {
          if (totalAmount <= 0) return 0;
          const ratio = totalAmount / target;
          const clamped = Math.min(ratio, 1);
          return clamped * maxPercent;
        }

        function computeTeamOverallStats(t) {
          if (!t || !t.daysCount || t.daysCount <= 0) {
            const manualQuality = t && t.manualQuality ? t.manualQuality : 0;
            const manualSheet = t && t.manualSheet ? t.manualSheet : 0;
            return {
              avgNonDonation: 0,
              donationTotalPercent: 0,
              manualQuality,
              manualSheet,
              overallCurrent: manualQuality + manualSheet
            };
          }

          const avgNonDonation = t.nonDonationTotalSum / t.daysCount;

          const donationMeatPercent = calcDonationPercent(
            t.donationMeatTotal || 0,
            DONATION_TARGETS.donation_meat,
            ITEM_MAX_PERCENT.donation_meat
          );
          const donationHousePercent = calcDonationPercent(
            t.donationHouseTotal || 0,
            DONATION_TARGETS.donation_house,
            ITEM_MAX_PERCENT.donation_house
          );
          const donationVarietyPercent = calcDonationPercent(
            t.donationVarietyTotal || 0,
            DONATION_TARGETS.donation_variety,
            ITEM_MAX_PERCENT.donation_variety
          );
          const productsPercent = calcDonationPercent(
            t.productsTotal || 0,
            DONATION_TARGETS.products,
            ITEM_MAX_PERCENT.products
          );

          const donationTotalPercent =
            donationMeatPercent + donationHousePercent + donationVarietyPercent + productsPercent;

          const manualQuality = t.manualQuality || 0;
          const manualSheet = t.manualSheet || 0;
          const overallCurrent = avgNonDonation + donationTotalPercent + manualQuality + manualSheet;

          return {
            avgNonDonation,
            donationTotalPercent,
            manualQuality,
            manualSheet,
            overallCurrent
          };
        }

        function updateMoneyProgressBars(teamStats) {
          const meatTotal = teamStats && teamStats.donationMeatTotal ? teamStats.donationMeatTotal : 0;
          const houseTotal = teamStats && teamStats.donationHouseTotal ? teamStats.donationHouseTotal : 0;
          const productsTotal = teamStats && teamStats.productsTotal ? teamStats.productsTotal : 0;

          const meatPercent = Math.min(meatTotal / DONATION_TARGETS.donation_meat, 1) * 100;
          const housePercent = Math.min(houseTotal / DONATION_TARGETS.donation_house, 1) * 100;
          const productsPercent = Math.min(productsTotal / DONATION_TARGETS.products, 1) * 100;

          const meatFill = document.getElementById('meatProgressFill');
          const meatText = document.getElementById('meatProgressText');
          if (meatFill && meatText) {
            meatFill.style.width = meatPercent + '%';
            meatText.textContent =
              `${meatTotal} / ${DONATION_TARGETS.donation_meat} (${meatPercent.toFixed(1)}Ùª)`;
          }

          const houseFill = document.getElementById('houseProgressFill');
          const houseText = document.getElementById('houseProgressText');
          if (houseFill && houseText) {
            houseFill.style.width = housePercent + '%';
            houseText.textContent =
              `${houseTotal} / ${DONATION_TARGETS.donation_house} (${housePercent.toFixed(1)}Ùª)`;
          }

          const productsFill = document.getElementById('productsProgressFill');
          const productsText = document.getElementById('productsProgressText');
          if (productsFill && productsText) {
            productsFill.style.width = productsPercent + '%';
            productsText.textContent =
              `${productsTotal} / ${DONATION_TARGETS.products} (${productsPercent.toFixed(1)}Ùª)`;
          }
        }

        function showScoreOverlay(score, rank, totalTeams, diffScore, prevRank, newRank) {
          const overlay = document.getElementById('scoreOverlay');
          const box = document.getElementById('scoreOverlayContent');
          const medal = getMedal(rank);

          let trend;
          if (diffScore > 0.05) {
            trend = `â¬†ï¸ Ø²Ø§Ø¯ ${diffScore.toFixed(1)} Ù†Ù‚Ø·Ø© Ø¹Ù† Ø¢Ø®Ø± Ù…Ø±Ø©`;
          } else if (diffScore < -0.05) {
            trend = `â¬‡ï¸ Ù‚Ù„Ù‘ ${Math.abs(diffScore).toFixed(1)} Ù†Ù‚Ø·Ø© Ø¹Ù† Ø¢Ø®Ø± Ù…Ø±Ø©`;
          } else {
            trend = 'Ø§Ù„Ù€ Score Ø«Ø§Ø¨Øª ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§ Ø²ÙŠ Ø¢Ø®Ø± Ù…Ø±Ø©';
          }

          let rankExtraText = '';
          let extraRocket = '';
          let extraClass = '';

          if (prevRank && prevRank > 0) {
            if (newRank < prevRank) {
              rankExtraText = `ğŸ”¥ Ø£Ø­Ù„Ù‰ Ù‚ÙØ²Ø©! Ø·Ù„Ø¹Øª Ù…Ù† Ø§Ù„Ù…Ø±ÙƒØ² ${prevRank} Ø¥Ù„Ù‰ ${newRank}.`;
              extraClass = 'rank-up';
            } else if (newRank > prevRank) {
              rankExtraText = `ğŸš€ Ù†Ø²Ù„Øª Ù…Ù† Ø§Ù„Ù…Ø±ÙƒØ² ${prevRank} Ø¥Ù„Ù‰ ${newRank}â€¦ Ø´Ø¯ Ø­ÙŠÙ„ÙƒÙ… Ø¨ÙƒØ±Ø© ğŸ’ª`;
              extraClass = 'rank-down';
              extraRocket = `<div class="rank-down-rocket">ğŸš€</div>`;
            }
          }

          const width = Math.min(score, MAX_TOTAL_PERCENT);

          box.classList.remove('rank-up', 'rank-down');
          if (extraClass) box.classList.add(extraClass);

          box.innerHTML = `
            ${extraRocket}
            <h2>âœ¨ Score Ø¬Ø¯ÙŠØ¯ Ù„ÙØ±ÙŠÙ‚Ùƒ âœ¨</h2>
            <p class="score-main">${score.toFixed(1)}Ùª Ù…Ù† ${MAX_TOTAL_PERCENT}Ùª</p>
            <div class="overlay-bar-wrapper">
              <div class="overlay-bar-fill" style="width:${width}%;"></div>
            </div>
            <p class="score-rank">ğŸ“Œ Ù…Ø±ÙƒØ²Ùƒ Ø§Ù„Ø¢Ù†: <strong>${newRank}${medal}</strong> Ù…Ù† ${totalTeams} ÙØ±ÙŠÙ‚</p>
            ${rankExtraText ? `<p class="score-rank">${rankExtraText}</p>` : ''}
            <p class="score-trend">${trend}</p>
            <button onclick="hideScoreOverlay()">ØªÙ…Ø§Ù… Ø´ÙƒØ±Ø§Ù‹ âœ¨</button>
          `;

          overlay.classList.remove('hidden');
        }

        function hideScoreOverlay() {
          document.getElementById('scoreOverlay').classList.add('hidden');
        }

        async function calculateDay() {
          if (!currentTeamName || !currentTeamKey) {
            alert('Ù…Ù† ÙØ¶Ù„Ùƒ Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ ÙƒÙ‚Ø§Ø¦Ø¯ ÙØ±ÙŠÙ‚ Ø£ÙˆÙ„Ø§Ù‹');
            return;
          }

          const dayDate = document.getElementById('dayDate').value;
          if (!dayDate) {
            alert('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø®ØªØ± ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ… Ù‚Ø¨Ù„ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø·');
            return;
          }

          const donationMeatToday = getNumber('donation_meat');
          const donationHouseToday = getNumber('donation_house');
          const donationVarietyToday = getNumber('donation_variety');
          const productsToday = getNumber('products_today');
          const sheetLink = document.getElementById('vol_sheet_link').value.trim();

          const photosInput = document.getElementById('fill_quality_photos');
          const photos = photosInput && photosInput.files ? Array.from(photosInput.files) : [];
          sessionMedia[currentTeamKey] = sessionMedia[currentTeamKey] || {};
          sessionMedia[currentTeamKey].photos = photos.map(file => URL.createObjectURL(file));

          const allStats = await getTeamsStats();

          let teamStats = allStats[currentTeamKey] || {
            name: currentTeamName,
            daysCount: 0,
            nonDonationTotalSum: 0,
            donationMeatTotal: 0,
            donationHouseTotal: 0,
            donationVarietyTotal: 0,
            productsTotal: 0,
            manualQuality: 0,
            manualSheet: 0,
            lastSheetLink: '',
            daysDates: [],
            fillTimeByDate: {}

          };
          if (!teamStats.fillTimeByDate || typeof teamStats.fillTimeByDate !== 'object') {
            teamStats.fillTimeByDate = {};
          }
          if (!teamStats.name) teamStats.name = currentTeamName;
          if (!Array.isArray(teamStats.daysDates)) teamStats.daysDates = [];

          if (teamStats.daysDates.includes(dayDate)) {
            alert('Ø§Ù„ÙŠÙˆÙ… Ø¨Ù‡Ø°Ø§ Ø§Ù„ØªØ§Ø±ÙŠØ® Ù…Ø³Ø¬Ù‘Ù„ Ø¨Ø§Ù„ÙØ¹Ù„ Ù„Ù‡Ø°Ø§ Ø§Ù„ÙØ±ÙŠÙ‚. Ø§Ø®ØªØ± ØªØ§Ø±ÙŠØ® Ù…Ø®ØªÙ„Ù.');
            return;
          }

          const prevStats = computeTeamOverallStats(teamStats);
          const prevScore = prevStats.overallCurrent;

          let prevRank = 0;
          {
            const scoresPre = [];
            Object.keys(allStats).forEach(key => {
              const ts = allStats[key];
              if (ts && ts.daysCount > 0) {
                const s = computeTeamOverallStats(ts);
                scoresPre.push({ key, score: s.overallCurrent });
              }
            });
            scoresPre.sort((a, b) => b.score - a.score);
            const idx = scoresPre.findIndex(x => x.key === currentTeamKey);
            prevRank = idx >= 0 ? idx + 1 : 0;
          }

          teamStats.donationMeatTotal += donationMeatToday;
          teamStats.donationHouseTotal += donationHouseToday;
          teamStats.donationVarietyTotal += donationVarietyToday;
          teamStats.productsTotal += productsToday;

          if (sheetLink) teamStats.lastSheetLink = sheetLink;

          const dailyBagsPercent = scoreDailyBags();
          const nonDonationToday =
            dailyBagsPercent +
            scoreVolTeamPresence() +
            scoreItem('vol_new_volunteers');

          teamStats.daysCount += 1;
          teamStats.nonDonationTotalSum += nonDonationToday;
          teamStats.daysDates.push(dayDate);

          allStats[currentTeamKey] = teamStats;
          await setTeamsStats(allStats);

          updateMoneyProgressBars(teamStats);

          const overallStats = computeTeamOverallStats(teamStats);
          const overallCurrent = overallStats.overallCurrent;

          const scores = [];
          Object.keys(allStats).forEach(key => {
            const ts = allStats[key];
            if (ts && ts.daysCount > 0) {
              const s = computeTeamOverallStats(ts);
              scores.push({ key, name: ts.name || decodeURIComponent(key), score: s.overallCurrent });
            }
          });
          scores.sort((a, b) => b.score - a.score);

          const rank = scores.findIndex(x => x.key === currentTeamKey) + 1;
          const totalTeams = scores.length;

          document.getElementById('resultText').innerHTML =
            `ØªÙ… ØªØ³Ø¬ÙŠÙ„ ÙŠÙˆÙ… ${dayDate} Ø¨Ù†Ø¬Ø§Ø­ âœ…<br>` +
            `Score Ø§Ù„Ø­Ø§Ù„ÙŠ: ${overallCurrent.toFixed(1)}Ùª â€“ Ø§Ù„Ù…Ø±ÙƒØ²: ${rank} Ù…Ù† ${totalTeams} ÙØ±ÙŠÙ‚${getMedal(rank)}.`;

          const tbody = document.getElementById('daysTableBody');
          const row = document.createElement('tr');

          const dateCell = document.createElement('td');
          dateCell.textContent = dayDate;

          const nonDonationCell = document.createElement('td');
          nonDonationCell.textContent = nonDonationToday.toFixed(1);

          const meatCell = document.createElement('td');
          meatCell.textContent = donationMeatToday;

          const houseCell = document.createElement('td');
          houseCell.textContent = donationHouseToday;

          const varietyCell = document.createElement('td');
          varietyCell.textContent = donationVarietyToday;

          const productsCell = document.createElement('td');
          productsCell.textContent = productsToday;

          row.appendChild(dateCell);
          row.appendChild(nonDonationCell);
          row.appendChild(meatCell);
          row.appendChild(houseCell);
          row.appendChild(varietyCell);
          row.appendChild(productsCell);
          tbody.appendChild(row);

          const diff = overallCurrent - prevScore;
          showScoreOverlay(overallCurrent, rank, totalTeams, diff, prevRank, rank);
        }

        async function updateManualScore(teamKey, field, value) {
          const stats = await getTeamsStats();
          if (!stats[teamKey]) return;

          let v = Number(value) || 0;

          if (field === 'manualQuality') {
            if (v < 0) v = 0;
            if (v > ITEM_MAX_PERCENT.fill_quality) v = ITEM_MAX_PERCENT.fill_quality;
            stats[teamKey].manualQuality = v;
          } else if (field === 'manualSheet') {
            if (v < 0) v = 0;
            if (v > ITEM_MAX_PERCENT.vol_sheet) v = ITEM_MAX_PERCENT.vol_sheet;
            stats[teamKey].manualSheet = v;
          }

          await setTeamsStats(stats);
          await buildAdminTable();
        }

        function showTeamPhotos(teamKey) {
          const container = document.getElementById('adminPhotosContainer');
          container.innerHTML = '';
          const media = sessionMedia[teamKey];
          if (!media || !media.photos || media.photos.length === 0) {
            container.textContent = 'Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ± Ù…Ø±ÙÙˆØ¹Ø© Ù„Ù„Ø¬ÙˆØ¯Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„ÙØ±ÙŠÙ‚ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø¬Ù„Ø³Ø©.';
            return;
          }
          media.photos.forEach(url => {
            const img = document.createElement('img');
            img.src = url;
            container.appendChild(img);
          });
        }

    async function buildAdminTable() {
  const stats = await getTeamsStats();
  const tbody = document.getElementById('adminTableBody');
  tbody.innerHTML = '';

  const keys = Object.keys(stats || {});
  if (keys.length === 0) {
    const row = document.createElement('tr');
    const cell = document.createElement('td');
    cell.colSpan = 12; // ÙƒØ§Ù† 10
    cell.textContent = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙØ±Ù‚ Ù…Ø³Ø¬Ù‘Ù„Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.';
    row.appendChild(cell);
    tbody.appendChild(row);
    return;
  }

  const rowsData = [];
  keys.forEach(key => {
    const t = stats[key];
    if (!t || !t.daysCount || t.daysCount <= 0) return;

    // Ø¶Ù…Ø§Ù† ÙˆØ¬ÙˆØ¯ fillTimeByDate
    if (!t.fillTimeByDate || typeof t.fillTimeByDate !== 'object') {
      t.fillTimeByDate = {};
    }

    const overallStats = computeTeamOverallStats(t);
    rowsData.push({ teamKey: key, teamName: t.name || decodeURIComponent(key), t, overallStats });
  });

  if (rowsData.length === 0) {
    const row = document.createElement('tr');
    const cell = document.createElement('td');
    cell.colSpan = 12; // ÙƒØ§Ù† 10
    cell.textContent = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙØ±Ù‚ Ù…Ø³Ø¬Ù‘Ù„Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.';
    row.appendChild(cell);
    tbody.appendChild(row);
    return;
  }

  rowsData.sort((a, b) => b.overallStats.overallCurrent - a.overallStats.overallCurrent);

  rowsData.forEach((item, index) => {
    const teamKey = item.teamKey;
    const teamName = item.teamName;
    const t = item.t;
    const s = item.overallStats;
    const rank = index + 1;

    const row = document.createElement('tr');

    const rankCell = document.createElement('td');
    rankCell.textContent = `${rank}${getMedal(rank)}`;

    const nameCell = document.createElement('td');
    nameCell.textContent = teamName;

    const daysCell = document.createElement('td');
    daysCell.textContent = t.daysCount;

    const avgNonDonationCell = document.createElement('td');
    avgNonDonationCell.textContent = s.avgNonDonation.toFixed(1);

    const donationCell = document.createElement('td');
    donationCell.textContent = s.donationTotalPercent.toFixed(1);

    const qualityCell = document.createElement('td');
    const qInput = document.createElement('input');
    qInput.type = 'number';
    qInput.min = '0';
    qInput.max = String(ITEM_MAX_PERCENT.fill_quality);
    qInput.value = (s.manualQuality || 0).toFixed(1).replace(/\.0$/, '');
    qInput.style.width = '70px';
    qInput.onchange = (e) => updateManualScore(teamKey, 'manualQuality', e.target.value);
    qualityCell.appendChild(qInput);

    const sheetCellScore = document.createElement('td');
    const sInput = document.createElement('input');
    sInput.type = 'number';
    sInput.min = '0';
    sInput.max = String(ITEM_MAX_PERCENT.vol_sheet);
    sInput.value = (s.manualSheet || 0).toFixed(1).replace(/\.0$/, '');
    sInput.style.width = '70px';
    sInput.onchange = (e) => updateManualScore(teamKey, 'manualSheet', e.target.value);
    sheetCellScore.appendChild(sInput);

    // âœ… NEW: ØªØ§Ø±ÙŠØ® ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ (Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ø£ÙŠØ§Ù… Ø§Ù„ÙØ±ÙŠÙ‚)
    const fillTimeDateCell = document.createElement('td');
    const dateSelect = document.createElement('select');
    dateSelect.style.width = '140px';
    dateSelect.style.padding = '6px 8px';
    dateSelect.style.borderRadius = '10px';
    dateSelect.style.border = '1px solid rgba(244,196,81,.20)';
    dateSelect.style.background = 'rgba(3,16,43,.82)';
    dateSelect.style.color = 'rgba(248,250,252,.95)';
    dateSelect.style.fontFamily = 'inherit';
    dateSelect.style.fontSize = '13px';

    const dates = Array.isArray(t.daysDates) ? t.daysDates.slice() : [];
    dates.sort(); // ØªØ±ØªÙŠØ¨ ØªØµØ§Ø¹Ø¯ÙŠ
    if (dates.length === 0) {
      const opt = document.createElement('option');
      opt.value = '';
      opt.textContent = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£ÙŠØ§Ù…';
      dateSelect.appendChild(opt);
      dateSelect.disabled = true;
    } else {
      dates.forEach(d => {
        const opt = document.createElement('option');
        opt.value = d;
        opt.textContent = d;
        dateSelect.appendChild(opt);
      });
      // Ø§Ø®ØªØ§Ø± Ø¢Ø®Ø± ÙŠÙˆÙ… Ø§ÙØªØ±Ø§Ø¶ÙŠÙ‹Ø§
      dateSelect.value = dates[dates.length - 1];
    }

    fillTimeDateCell.appendChild(dateSelect);

    // âœ… NEW: Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ + Ø­ÙØ¸
    const fillTimeCell = document.createElement('td');
    const ftInput = document.createElement('input');
    ftInput.type = 'number';
    ftInput.min = '0';
    ftInput.max = '25';
    ftInput.placeholder = '0-25';
    ftInput.style.width = '70px';

    // ØªØ­Ù…ÙŠÙ„ Ù‚ÙŠÙ…Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© Ù„Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
    const initDate = dateSelect.value;
    const initVal = initDate ? t.fillTimeByDate?.[initDate] : undefined;
    if (typeof initVal === 'number') ftInput.value = initVal;

    const saveBtn = document.createElement('button');
    saveBtn.type = 'button';
    saveBtn.textContent = 'Ø­ÙØ¸';
    saveBtn.style.marginTop = '6px';
    saveBtn.style.padding = '8px 10px';
    saveBtn.style.borderRadius = '999px';

    // Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„ØªØ§Ø±ÙŠØ®: Ø§Ø¹Ø±Ø¶ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¥Ù† ÙˆÙØ¬Ø¯Øª
    dateSelect.onchange = () => {
      const d = dateSelect.value;
      const v = d ? t.fillTimeByDate?.[d] : undefined;
      ftInput.value = (typeof v === 'number') ? v : '';
    };

    saveBtn.onclick = async () => {
      const d = dateSelect.value;
      if (!d) {
        alert('Ø§Ø®ØªØ± ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚ÙŠÙŠÙ…');
        return;
      }
      const v = Number(ftInput.value);
      if (Number.isNaN(v) || v < 0 || v > 25) {
        alert('Ø¯Ø±Ø¬Ø© Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ù„Ø§Ø²Ù… ØªÙƒÙˆÙ† Ø¨ÙŠÙ† 0 Ùˆ 25');
        return;
      }

      await updateFillTimeForDate(teamKey, d, v);

      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ø¹Ø´Ø§Ù† Ù„Ù…Ø§ ØªØºÙŠÙ‘Ø± Ø§Ù„ØªØ§Ø±ÙŠØ® ØªÙ„Ø§Ù‚ÙŠÙ‡Ø§ Ù…ÙˆØ¬ÙˆØ¯Ø©
      t.fillTimeByDate = t.fillTimeByDate || {};
      t.fillTimeByDate[d] = v;
    };

    fillTimeCell.appendChild(ftInput);
    fillTimeCell.appendChild(document.createElement('div')).appendChild(saveBtn);

    const overallCell = document.createElement('td');
    overallCell.textContent = s.overallCurrent.toFixed(1);

    const photosCell = document.createElement('td');
    const media = sessionMedia[teamKey];
    if (media && media.photos && media.photos.length > 0) {
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.textContent = 'Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±';
      btn.onclick = () => showTeamPhotos(teamKey);
      photosCell.appendChild(btn);
    } else {
      photosCell.textContent = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ (Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø¬Ù„Ø³Ø©)';
    }

    const sheetLinkCell = document.createElement('td');
    if (t.lastSheetLink) {
      const a = document.createElement('a');
      a.href = t.lastSheetLink;
      a.target = '_blank';
      a.textContent = 'ÙØªØ­ Ø§Ù„Ø´ÙŠØª';
      sheetLinkCell.appendChild(a);
    } else {
      sheetLinkCell.textContent = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
    }

    row.appendChild(rankCell);
    row.appendChild(nameCell);
    row.appendChild(daysCell);
    row.appendChild(avgNonDonationCell);
    row.appendChild(donationCell);
    row.appendChild(qualityCell);
    row.appendChild(sheetCellScore);

    // âœ… NEW columns
    row.appendChild(fillTimeDateCell);
    row.appendChild(fillTimeCell);

    row.appendChild(overallCell);
    row.appendChild(photosCell);
    row.appendChild(sheetLinkCell);

    tbody.appendChild(row);
  });

  document.getElementById('admin')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

        async function updateFillTimeForDate(teamKey, dayDate, value) {
  const stats = await getTeamsStats();
  if (!stats[teamKey]) return;

  stats[teamKey].fillTimeByDate = stats[teamKey].fillTimeByDate || {};
  stats[teamKey].fillTimeByDate[dayDate] = value;

  await setTeamsStats(stats);
  await buildAdminTable();
}
window.updateFillTimeForDate = updateFillTimeForDate;

        window.handleLogin = handleLogin;
        window.goBackToLogin = goBackToLogin;
        window.toggleDaysSummary = toggleDaysSummary;
        window.calculateDay = calculateDay;
        window.buildAdminTable = buildAdminTable;
        window.hideScoreOverlay = hideScoreOverlay;
        window.updateManualScore = updateManualScore;
        window.showTeamPhotos = showTeamPhotos;
      </script>

    </div>
  </div>
</body>
</html>
